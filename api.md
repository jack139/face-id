
## api 文档

### 1. 人脸定位
> 检测图片中人脸并返回位置

输入参数

| 参数         | 必选 | 类型   | 说明                                              |
| ------------ | ---- | ------ | ------------------------------------------------- |
| image        | 是   | string | base64编码图片数据                                |
| max_face_num | 否   | int    | 最多定位的人脸数量，默认为1，仅检测面积最大的一个 |

返回结果

| 参数      | 必选 | 类型  | 说明                 |
| --------- | ---- | ----- | -------------------- |
| face_num  | 是   | int   | 检测到的图片人脸数量 |
| locations | 是   | array | 人脸位置坐标列表     |
| + top     | 是   | int   | 人脸上边界           |
| + right   | 是   | int   | 人脸右边界           |
| + botton  | 是   | int   | 人脸下边界           |
| + left    | 是   | int   | 人脸左边界           |



### 2. 人脸对比

> 比对两张照片中人脸的相似度（1:1），返回相似度分值

输入参数

| 参数   | 必选 | 类型   | 说明               |
| ------ | ---- | ------ | ------------------ |
| image1 | 是   | string | base64编码图片数据 |
| image2 | 是   | string | base64编码图片数据 |

返回结果

| 参数      | 必选 | 类型   | 说明                      |
| --------- | ---- | ------ | ------------------------- |
| identical | 是   | string | 是否同一人，TRUE 或 FALSE |
| score     | 是   | float  | 相似度得分                |



### 3. 人脸搜索

> 1:N识别，在指定人脸集合中，找到最相似的人脸

输入参数

| 参数         | 必选 | 类型   | 说明                                                         |
| ------------ | ---- | ------ | ------------------------------------------------------------ |
| image        | 是   | string | base64编码图片数据                                           |
| group_id     | 是   | string | 在指定分组内搜索                                             |
| user_id      | 否   | string | 如果提供，则与指定user_id的用户进行比对，相当于1:1           |
| max_user_num | 否   | int    | 查找后返回的用户数量，返回相似度最高的几个用户，默认为5，最多返回5个 |

返回结果

| 参数          | 必选 | 类型   | 说明                                  |
| ------------- | ---- | ------ | ------------------------------------- |
| user_list     | 是   | string | 匹配到的用户列表                      |
| + user_id     | 是   | string | 用户id                                |
| + name        | 是   | string | 用户姓名，如果注册时有提供            |
| + mobile_tail | 是   | string | 手机号后4位，如果注册了手机号         |
| + score       | 是   | float  | 相似度得分                            |
| + location    | 是   | array  | 人脸的位置 (top, right, bottom, left) |



### 4. 特征库管理

#### (1) 特征库结构

```
|- 特征库
   |- 分组一（group_id）
      |- 用户01（user_id）
         |- 人脸（face_token）
      |- 用户02（user_d）
         |- 人脸（face_token）
         |- 人脸（face_token）
         ....
       ....
   |- 分组二（group_id）
   |- 分组三（group_id）
   ....
```



#### (2) 人脸注册

> 向特征库中添加人脸，当user_id在库中已经存在时，新注册的图片会追加到该user_id下

输入参数

| 参数     | 必选 | 类型   | 说明                                                         |
| -------- | ---- | ------ | ------------------------------------------------------------ |
| image    | 是   | string | base64编码图片数据                                           |
| group_id | 是   | string | 用户分组id                                                   |
| user_id  | 是   | string | 用户id（由数字、字母、下划线组成），必须唯一，建议使用身份证号码 |
| mobile   | 否   | string | 手机号码                                                     |
| memo     | 否   | string | 用户其他信息，例如：姓名                                     |

返回结果

| 参数       | 必选   | 类型             | 说明 |
| ---------- | ------ | ---------------- | ---- |
| face_token | string | 人脸特征唯一标识 |      |



#### (3) 人脸更新

> 更新特征库中指定用户下的人脸信息，使用新图替换库中该user_id下所有图片，若user_id不存在则报错

输入参数

| 参数     | 必选 | 类型   | 说明                     |
| -------- | ---- | ------ | ------------------------ |
| image    | 是   | string | base64编码图片数据       |
| group_id | 是   | string | 用户分组id               |
| user_id  | 是   | string | 用户id                   |
| mobile   | 否   | string | 手机号码                 |
| memo     | 否   | string | 用户其他信息，例如：姓名 |

返回结果

| 参数       | 必选   | 类型             | 说明 |
| ---------- | ------ | ---------------- | ---- |
| face_token | string | 人脸特征唯一标识 |      |



#### (4) 人脸删除

> 删除指定用户的某张人脸特征数据

输入参数

| 参数       | 必选 | 类型   | 说明         |
| ---------- | ---- | ------ | ------------ |
| group_id   | 是   | string | 用户分组id   |
| user_id    | 是   | string | 用户id       |
| face_token | 是   | string | 人脸特征标识 |

返回结果

| 参数       | 必选 | 类型   | 说明                          |
| ---------- | ---- | ------ | ----------------------------- |
| type | 是   | string | 返回结果类型：SUCCESS 或 FAIL |



#### (5) 用户信息查询

> 查询特征库中某个用户的详细信息

输入参数

| 参数     | 必选 | 类型   | 说明       |
| -------- | ---- | ------ | ---------- |
| group_id | 是   | string | 用户分组id |
| user_id  | 是   | string | 用户id     |

返回结果

| 参数      | 必选 | 类型   | 说明                           |
| --------- | ---- | ------ | ------------------------------ |
| group_id  | 是   | string | 分组id                         |
| user_id   | 是   | string | 用户id                         |
| mobile    | 否   | string | 手机号码，如果注册时有提供     |
| memo      | 否   | string | 用户其他信息，如果注册时有提供 |
| image_num | 是   | int    | 此user_id下已注册的照片数量    |



#### (6) 获取用户人脸列表

> 获取某个用户组中的全部人脸列表

输入参数

| 参数     | 必选 | 类型   | 说明                        |
| -------- | ---- | ------ | --------------------------- |
| group_id | 是   | string | 用户分组id                  |
| user_id  | 是   | string | 用户id                      |
| start    | 否   | int    | 起始位置，默认为0           |
| length   | 否   | int    | 返回数量，默认100，最大1000 |

返回结果

| 参数         | 必选 | 类型   | 说明         |
| ------------ | ---- | ------ | ------------ |
| face_list    | 是   | array  | 人脸特征列表 |
| + face_token | 是   | string | 人脸特征标识 |
| + ctime      | 是   | string | 注册时间     |



#### (7) 获取用户列表

> 查询指定用户组中的用户列表

输入参数

| 参数     | 必选 | 类型   | 说明                        |
| -------- | ---- | ------ | --------------------------- |
| group_id | 是   | string | 用户分组id                  |
| start    | 否   | int    | 起始位置，默认为0           |
| length   | 否   | int    | 返回数量，默认100，最大1000 |

返回结果

| 参数      | 必选 | 类型   | 说明     |
| --------- | ---- | ------ | -------- |
| user_list | 是   | array  | 用户列表 |
| + user_id | 是   | string | 用户id   |



#### (8) 复制用户

> 将指定用户复制到另外的人脸组

输入参数

| 参数         | 必选 | 类型   | 说明                 |
| ------------ | ---- | ------ | -------------------- |
| user_id      | 是   | string | 用户id               |
| src_group_id | 是   | string | 从指定组里复制信息   |
| dst_group_id | 是   | string | 需要添加用户的分组id |

返回结果

| 参数 | 必选 | 类型   | 说明                          |
| ---- | ---- | ------ | ----------------------------- |
| type | 是   | string | 返回结果类型：SUCCESS 或 FAIL |



#### (9) 删除用户

> 删除指定用户

输入参数

| 参数     | 必选 | 类型   | 说明       |
| -------- | ---- | ------ | ---------- |
| group_id | 是   | string | 用户分组id |
| user_id  | 是   | string | 用户id     |

返回结果

| 参数 | 必选 | 类型   | 说明                          |
| ---- | ---- | ------ | ----------------------------- |
| type | 是   | string | 返回结果类型：SUCCESS 或 FAIL |



#### (10) 创建用户组

> 创建一个新的用户组，如果用户组已存在 则返回错误

输入参数

| 参数     | 必选 | 类型   | 说明                                               |
| -------- | ---- | ------ | -------------------------------------------------- |
| group_id | 是   | string | 用户组id，标识一组用户（由数字、字母、下划线组成） |

返回结果

| 参数 | 必选 | 类型   | 说明                          |
| ---- | ---- | ------ | ----------------------------- |
| type | 是   | string | 返回结果类型：SUCCESS 或 FAIL |



#### (11) 删除用户组

> 删除指定用户组，如果组不存在 则返回错误。后台异步进行删除

输入参数

| 参数     | 必选 | 类型   | 说明       |
| -------- | ---- | ------ | ---------- |
| group_id | 是   | string | 用户分组id |

返回结果

| 参数 | 必选 | 类型   | 说明                          |
| ---- | ---- | ------ | ----------------------------- |
| type | 是   | string | 返回结果类型：SUCCESS 或 FAIL |



#### (12) 获取用户组列表

> 查询特征库中用户组的列表

输入参数

| 参数   | 必选 | 类型 | 说明                        |
| ------ | ---- | ---- | --------------------------- |
| start  | 否   | int  | 起始位置，默认为0           |
| length | 否   | int  | 返回数量，默认100，最大1000 |

返回结果

| 参数       | 必选 | 类型   | 说明       |
| ---------- | ---- | ------ | ---------- |
| group_list | 是   | array  | 用户组列表 |
| + group_id | 是   | string | 用户组id   |

